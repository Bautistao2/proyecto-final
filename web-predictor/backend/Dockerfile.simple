FROM python:3.12-slim

WORKDIR /app

COPY requirements_app1.txt .
RUN pip install --no-cache-dir -r requirements_app1.txt

COPY src ./src

# Configurar variables de entorno para indicar que estamos en Docker
ENV DOCKER=true
ENV PYTHONPATH="${PYTHONPATH}:/app:/app/model"

EXPOSE 8000

# Simple comando para iniciar la aplicaciÃ³n sin scripts adicionales
CMD ["sh", "-c", "echo 'ðŸ“‚ Buscando modelos...' && find /app -name '*.joblib' -type f | sort && echo 'ðŸ” Verificando estructura...' && ls -la /app/model/ 2>/dev/null || echo 'Directorio model no encontrado' && echo 'ðŸš€ Iniciando API...' && uvicorn src.main:app --host 0.0.0.0 --port 8000"]
